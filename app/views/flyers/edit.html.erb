<%= render partial: "/shared/errors", locals: {record: @flyer} %>

<% breadcrumb :edit_flyer, @campaign, @template, @flyer %>
<% content_for :breadcrumb_extras do %>
  <ol class="options cf">
    <li><a href="#" title="Save" data-save="true"><span class="icons">V</span> Save</a></li>
    <li><a href="/duplicate" title="Duplicate"><span class="icons">c</span> Duplicate</a></li>
    <li><a href="/share" title="Share"><span class="icons">s</span> Share</a></li> 
    <li><a href="/download" title="Download"><span class="icons">d</span> Download</a></li> 
    <li><%= link_to "<span class='icons'>x</span> Delete".html_safe, campaign_template_flyer_path(@campaign, @template, @flyer), method: :delete, confirm: "Are you sure?" %></li>
  </ol>
<% end %>

<script type="text/javascript">
  window.Toolkit.Flyer.savedData = {};

  <% @flyer.data.each do |datum| %>
    window.Toolkit.Flyer.savedData.<%= datum.key %> = {
      fieldID: <%= datum.field_id.to_json.html_safe %>,
      value:   <%= datum.value.to_json.html_safe %>
    };
  <% end %>
</script>

<%= render partial: "/shared/errors", locals: {record: @flyer} %>
<%= render 'form' %>
<%= render partial: "images/choose" %>

<!-- This is a hidden div that holds any custom text for the form so we can parse it with jQuery and insert it into the correct field. -->
<div id="custom-text" style="display:none"></div>
